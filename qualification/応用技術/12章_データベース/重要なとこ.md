- DBMS
  - 応用ソフトウェアと基本ソフトウェアの間のミドルウェアとして機能
### 用語
- 関係データベース
  - 表(テーブル)・行(レコード)・列(フィールド)でできている一般的なデータベース
- 正規化
  - 同じようなデータが存在する場合に別テーブルに分けて下のテーブルにはIDを持たせるやり方
- ビュー表
  - データを取得する際に切り出したり結合したり選択したデータを一時的に保持するテーブル
- 3層スキーマ構造
### データベースの設計
- 手順
  - 概念設計 → 論理設計 → 物理設計
- 概念設計
  - 業務分析を行ってモデル化する
  - どのようなテーブルが必要かを定義する
- 論理設計
  - データをどのように管理するか
  - フィールドを定義するイメージ
- 物理設計
  - ハードウェアの設計をする
  - どれくらいの性能・障害発生時の対応はどうするかなど

### インデックス(p.446)
- 大量のデータがあると検索速度が落ちる。
  - インデックスを設定することで木構造が構築され、検索が早くなる
- ただし、インデックスは表と別にデータを保持するため、表が更新されるとインデックス側のデータも更新が必要となる。
- 下記の場合はインデックスは不必要
  - レコード数が少ない
  - インデックスを設定したカラムの列の値の種類が少ない
  - そもそも検索されない

### 関数従属と部分従属
- 関数従属
  - 主キーが決まれば列の値が一意に定まる関係
- 部分関数従属
  - 主キーは複合キーで、それぞれのキーごとに列が決まる関係
- 部分関数従属は、外部キーで別テーブルからデータを参照する際に使用する。

### 副問合せ
- SELECT文の中にSELECT文を埋め込んで入れ子状態で用いることを副問合せという。
- IN句を使用する
```
SELECT * FROM 商品表
WHERE 商品コード
NOT IN (SELECT 商品コード FROM 在庫表)
```
- ①在庫表にある商品コードを全て取得する。
- ②①の商品コード以外の商品コードを取得する。

### EXISTS句
- 存在チェックを行い、EXIST句はtrue,falseで結果を返す。
```
SELECT * FROM 商品表
WHERE EXISTS (EXIST句)
```
EXIST句がtrueになったデータだけ出力できる。

### トランザクションと排他制御
- トランザクション
  - 一連の処理をひとまとめにしたもの
- 排他制御
  - 処理中のデータをロックして、他の人が読み書きできないようにする機能。
    - 誰かに割り込まれたりしてデータの不整合を生じさせないようにする。
  - ロックの方法
    - 共有ロック
      - 他のユーザーはロック中にデータを読み込むことはできるが書くことはできない
    - 専有ロック
      - 他のユーザーはロック中にデータを読むことも書くこともできない
    - デッドロック
      - お互いがお互いのロック解除を待ち続ける状態。

### ストアドプロシージャ
- データベースを操作する一連の処理手順(SQL文)を一つにまとめてDBMSに保存しておくこと。

### データベースの障害管理
- ジャーナル
  - ログファイルで、更新前の状態と更新後の状態を逐一記録して、更新履歴を管理する。
- コミット
  - トランザクションは一連の処理が問題なく実行できた時、最後にその更新を確定することで、データベースに更新内容を反映させる。これをコミットという。
- ロールバック
  - トランザクション中に処理が失敗した場合、データベースの更新前の状態をジャーナルから取得し、トランザクション開始直前の状態に戻す
- ロールフォワード
  - バックアップファイルによる復元から、データベースを障害発生直前の状態まで復旧させること

### チェックポイント
- DBMSの中に、更新データは主記憶上のバッファに保存される。
- バッファ内のデータは一定間隔で補助記憶装置のデータベースに反映される。
- この反映を行うイベントのことをチェックポイントという。

## 分散データベース
- 物理的に分かれている複数のデータベースを見かけ上一つのデータベースとして扱えるようにする。システムのこと。
